{% extends 'chair/base.html' %}
{% load conferences_extras %}


{#---------------------------------------------------------------------------#}
{# Navigation and breadcrumbs                                                #}
{#---------------------------------------------------------------------------#}
{% block navigation %}
  {% include 'chair/components/navigation.html' with active='submissions' %}
{% endblock %}

{% block chairCrumbItemsSmall %}
  <li class="breadcrumb-item">
    <a href="{% url 'chair:submissions' pk=conference.pk %}">submissions</a>
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'chair:submission-details' pk=submission.pk %}">#{{ submission.pk }}</a>
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'chair:select-reviewers' pk=submission.pk %}">Reviewers</a>
  </li>
{% endblock %}

{% block chairCrumbItemsLarge %}
  <li class="breadcrumb-item">
    <a href="{% url 'chair:users' pk=conference.pk %}">users</a>
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'chair:user' pk=conference.pk user_pk=member.pk %}">#{{ member.pk }} - {{ member.profile.get_full_name }}</a>
  </li>
{% endblock %}


{#---------------------------------------------------------------------------#}
{# Main content                                                              #}
{#---------------------------------------------------------------------------#}
{% block mainPanelContent %}
  <div class="container my-3">
    {% if next_url %}
      <div class="d-flex">
        <a href="{{ next_url }}" class="btn btn-outline-secondary"><i class="fas fa-chevron-left"></i> Back</a>
      </div>
    {% endif %}
  </div>

  {% for submission in conference|list_submission_by:member %}
    <div class="modal fade" id="submission-{{ submission.pk }}-modal"
         data-src="{% url 'chair:get-submission-overview' submission.pk %}">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Submission #{{ submission.pk }}</h5>
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  {% endfor %}

{% endblock %}


{% block script %}
<script>
// Get modal body content on modal show:
const modals = $('.modal[data-src]');
console.log(modals);
modals.on('show.bs.modal', function () {
  const thisModal = $(this);
  $(this).find('.modal-body').load(thisModal.attr('data-src'));
});
</script>
{% endblock %}
